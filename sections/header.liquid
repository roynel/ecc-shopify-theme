<header class="header">
  <!-- Mobile Hamburger and Top Bar -->
  <div class="mobile-header-top">
    <button class="hamburger-menu">
      <svg class="hamburger-icon" viewBox="0 0 24 24" width="24" height="24">
        <path fill="currentColor" d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
      </svg>
      <svg class="close-icon" viewBox="0 0 24 24" width="24" height="24" style="display: none;">
        <path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
      </svg>
    </button>

    <a href="/" class="logo">
      {% if section.settings.logo %}
        <img 
          src="{{ section.settings.logo | image_url: width: 500 }}" 
          alt="{{ shop.name }}"
          class="logo-image"
          style="height: 120px; width: auto;"
        >
      {% else %}
        <span>{{ shop.name }}</span>
      {% endif %}
    </a>

    <div class="mobile-header-actions">
      <a href="/account" class="user-link">
        <svg class="user-icon" viewBox="0 0 24 24" width="24" height="24">
          <path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
        </svg>
      </a>
      <a href="/cart" class="cart-link">
        <svg class="cart-icon" viewBox="0 0 24 24" width="24" height="24">
          <path fill="currentColor" d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
        </svg>
        <span class="cart-count">{{ cart.item_count }}</span>
      </a>
    </div>
  </div>

  <!-- Mobile Search Bar -->
  <div class="mobile-search-bar">
    <form action="/search">
      <input 
        type="text" 
        name="q" 
        placeholder="Search..." 
        class="search-input"
      >
    </form>
  </div>

  <!-- Desktop Header (Existing Code) -->
  <div class="header-top">
    <a href="/" class="logo">
      {% if section.settings.logo %}
        <img 
          src="{{ section.settings.logo | image_url: width: 500 }}" 
          alt="{{ shop.name }}"
          class="logo-image"
          style="height: 120px; width: auto;"
        >
      {% else %}
        <span>{{ shop.name }}</span>
      {% endif %}
    </a>

    <div class="search-bar">
      <form action="/search">
        <button type="submit" class="search-button">
          <svg class="search-icon" viewBox="0 0 24 24" width="20" height="20">
            <path fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 0 0 1.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 0 0-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 0 0 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
          </svg>
        </button>
        <input 
          type="text" 
          name="q" 
          placeholder=" " 
          class="search-input"
        >
        <span class="search-placeholder">
          Search for <span class="animated-text"></span>
        </span>
      </form>
    </div>

    <div class="header-actions">
      <a href="/account" class="user-link">
        <svg class="user-icon" viewBox="0 0 24 24" width="24" height="24">
          <path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
        </svg>
      </a>
      <a href="/cart" class="cart-link">
        <svg class="cart-icon" viewBox="0 0 24 24" width="24" height="24">
          <path fill="currentColor" d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
        </svg>
        <span class="cart-count">{{ cart.item_count }}</span>
      </a>
    </div>
  </div>

  <!-- Navigation (Desktop) -->
  <nav 
    class="header-nav" 
    style="
      background-color: {{ section.settings.nav_bg_color }};
      color: {{ section.settings.nav_text_color }};
      {% if section.settings.nav_bg_image %} 
        background-image: url({{ section.settings.nav_bg_image | image_url }});
        background-repeat: repeat;
        background-size: auto;
        opacity: {{ section.settings.nav_bg_opacity | divided_by: 100.0 }};
      {% endif %}
    "
  >
    {% for link in linklists.main-menu.links %}
      <a href="{{ link.url }}" class="nav-link">{{ link.title }}</a>
    {% endfor %}
  </nav>

  <!-- Mobile Menu Dropdown -->
  <div class="mobile-menu">
    {% for link in linklists.main-menu.links %}
      <a href="{{ link.url }}" class="nav-link">{{ link.title }}</a>
    {% endfor %}
  </div>
</header>

{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo"
    },
    {
      "type": "header",
      "content": "Navigation Settings"
    },
    {
      "type": "color",
      "id": "nav_bg_color",
      "label": "Background Color",
      "default": "#000000"
    },
    {
      "type": "image_picker",
      "id": "nav_bg_image",
      "label": "Background Image (Optional)"
    },
    {
      "type": "range",
      "id": "nav_bg_opacity",
      "label": "Image Opacity",
      "min": 0,
      "max": 100,
      "step": 10,
      "unit": "%",
      "default": 100
    },
    {
      "type": "color",
      "id": "nav_text_color",
      "label": "Text Color",
      "default": "#ffffff"
    }
  ]
}
{% endschema %}